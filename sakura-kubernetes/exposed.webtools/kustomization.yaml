---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - resources.yaml
# bases:
#   - base

namespace: exposed
commonLabels:
  kustomize: webtools
namePrefix: webtools-

configMapGenerator:
  - name: configmap-from-file-content
    files:
      - files/nginx_cmd.sh
      - files/nginx_index.html
      - files/settings.toml.envsubst
      - files/webtools_command.sh

secretGenerator:
  - name: secret-from-file
    files:
      - secrets/minio_secret_key

vars:
  - name: REDIS_SERVICE_NAME
    objref:
      apiVersion: v1
      kind: Service
      name: redis-service
    fieldref:
      fieldpath: metadata.name
  - name: MINIO_SERVICE_NAME
    objref:
      apiVersion: v1
      kind: Service
      name: minio-service
    fieldref:
      fieldpath: metadata.name
