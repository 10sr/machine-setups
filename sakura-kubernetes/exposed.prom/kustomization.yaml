---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - resources.yaml
# bases:
#   - base

namespace: exposed
commonLabels:
  kustomize: prom
namePrefix: prom-

configMapGenerator:
  - name: configmap-files
    files:
      - files/alertmanager.yml.envsubst
      - files/nginx.conf
      - files/nginx_cmd.sh
      - files/prom_envsubst.sh
      - files/prometheus.yml.envsubst
      - files/rules.yml
      - files/up.sh
secretGenerator:
  - name: secret-files
    files:
      - secrets/node_exporter_password

vars:
  - name: PROM_SERVICE_NAME
    objref:
      apiVersion: v1
      kind: Service
      name: prom-service
    fieldref:
      fieldpath: metadata.name
  # - name: AM_SERVICE_NAME
  #   objref:
  #     apiVersion: v1
  #     kind: Service
  #     name: am-service
  #   fieldref:
  #     fieldpath: metadata.name
