---
version: '3'
services:
  prom:
    image: prom/prometheus:v2.8.0
    ports:
      - "127.0.0.1:9090:9090"
    environment: {}
    user: "1000"
    volumes:
      # - "./entrypoint.sh:/entrypoint.sh:ro"
      - "./prometheus.yml:/etc/prometheus/prometheus.yml:ro"
      - "./rules.yml:/etc/prometheus/rules.yml:ro"
      # TODO: chown 1000 this directory
      - "/var/lib/data/docker/prometheus0/data:/prometheus"
    # entrypoint: sh /entrypoint.sh
    # command:
    #   # Same as default
    #   - "-config.file=/etc/prometheus/prometheus.yml"
    #   - "-storage.local.path=/prometheus"
    #   - "-web.console.libraries=/etc/prometheus/console_libraries"
    #   - "-web.console.templates=/etc/prometheus/consoles"

  am:
    image: prom/alertmanager:v0.16.2
    ports:
      - "127.0.0.1:9093:9093"
    user: "1000"
    volumes:
      - "./alertmanager.yml:/etc/alertmanager/alertmanager.yml:ro"
      # TODO: chown 1000 this directory
      - "/var/lib/data/docker/prometheus0/am:/alertmanager"
